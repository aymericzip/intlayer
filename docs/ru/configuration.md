# Документация по настройке Intlayer

## Обзор

Файлы конфигурации Intlayer позволяют настраивать различные аспекты плагина, такие как интернационализация, промежуточное ПО и обработка контента. Этот документ предоставляет детальное описание каждого свойства в конфигурации.

---

## Поддержка файлов конфигурации

Intlayer принимает форматы файлов конфигурации JSON, JS, MJS и TS:

- `intlayer.config.ts`
- `intlayer.config.js`
- `intlayer.config.json`
- `intlayer.config.cjs`
- `intlayer.config.mjs`
- `.intlayerrc`

---

## Пример файла конфигурации

```typescript
// intlayer.config.ts

import { Locales, type IntlayerConfig } from "intlayer";

const config: IntlayerConfig = {
  internationalization: {
    locales: [Locales.ENGLISH],
  },
  content: {
    typesDir: "content/types",
  },
  middleware: {
    noPrefix: false,
  },
};

export default config;
```

```javascript
// intlayer.config.cjs

const { Locales } = require("intlayer");

/** @type {import('intlayer').IntlayerConfig} */
const config = {
  internationalization: {
    locales: [Locales.ENGLISH],
  },
  content: {
    typesDir: "content/types",
  },
  middleware: {
    noPrefix: false,
  },
};

module.exports = config;
```

```json5
// .intlayerrc

{
  "internationalization": {
    "locales": ["en"],
  },
  "content": {
    "typesDir": "content/types",
  },
  "middleware": {
    "noPrefix": false,
  },
}
```

---

## Справочник по конфигурации

Следующие разделы описывают различные настройки конфигурации, доступные для Intlayer.

---

### Конфигурация интернационализации

Определяет настройки, связанные с интернационализацией, включая доступные локали и локаль по умолчанию для приложения.

#### Свойства

- **locales**:
  - _Тип_: `string[]`
  - _По умолчанию_: `['en']`
  - _Описание_: Список поддерживаемых локалей в приложении.
  - _Пример_: `['en', 'fr', 'es']`
- **strictMode**:

  - _Тип_: `string`
  - _По умолчанию_: `required_only`
  - _Описание_: Обеспечивает строгую реализацию интернационализированного контента с использованием typescript.
  - _Заметка_: Если установлено "strict", функция перевода `t` потребует, чтобы каждая объявленная локаль была определена. Если одна локаль отсутствует или если локаль не объявлена в вашей конфигурации, будет выброшена ошибка.
  - _Заметка_: Если установлено "required_only", функция перевода `t` потребует, чтобы каждая объявленная локаль была определена. Если одна локаль отсутствует, будет выброшено предупреждение. Но будет принято, если локаль не объявлена в вашей конфигурации, но существует.
  - _Заметка_: Если установлено "loose", функция перевода `t` примет любую существующую локаль.

- **defaultLocale**:
  - _Тип_: `string`
  - _По умолчанию_: `'en'`
  - _Описание_: Локаль по умолчанию, используемая как резервная, если запрашиваемая локаль не найдена.
  - _Пример_: `'en'`
  - _Заметка_: Это используется для определения локали, когда ни одна не указана в URL, cookie или заголовке.

---

### Конфигурация редактора

Определяет настройки, связанные с интегрированным редактором, включая порт сервера и статус активности.

#### Свойства

- **backendURL**:

  - _Тип_: `string`
  - _По умолчанию_: `https://back.intlayer.org`
  - _Описание_: URL серверной части.
  - _Пример_: `http://localhost:4000`

- **enabled**:

  - _Тип_: `boolean`
  - _По умолчанию_: `true`
  - _Описание_: Указывает, активен ли редактор.
  - _Пример_: `true`
  - _Заметка_: Может быть установлен с использованием NODE_ENV или другой переменной окружения

- **clientId**:

  - _Тип_: `string` | `undefined`
  - _По умолчанию_: `undefined`
  - _Описание_: clientId и clientSecret позволяют пакетам intlayer аутентифицироваться с сервером с использованием аутентификации oAuth2. Токен доступа используется для аутентификации пользователя, связанного с проектом. Чтобы получить токен доступа, перейдите на https://back.intlayer.org/dashboard/project и создайте аккаунт.
  - _Пример_: `true`
  - _Заметка_: Важно: clientId и clientSecret должны храниться в секрете и не должны быть общедоступными. Убедитесь, что они хранятся в безопасном месте, таком как переменные окружения.

- **clientSecret**:
  - _Тип_: `string` | `undefined`
  - _По умолчанию_: `undefined`
  - _Описание_: clientId и clientSecret позволяют пакетам intlayer аутентифицироваться с сервером с использованием аутентификации oAuth2. Токен доступа используется для аутентификации пользователя, связанного с проектом. Чтобы получить токен доступа, перейдите на https://back.intlayer.org/dashboard/project и создайте аккаунт.
  - _Пример_: `true`
  - _Заметка_: Важно: clientId и clientSecret должны храниться в секрете и не должны быть общедоступными. Убедитесь, что они хранятся в безопасном месте, таком как переменные окружения.

### Конфигурация промежуточного ПО

Настройки, которые контролируют поведение промежуточного ПО, включая то, как приложение обрабатывает cookie, заголовки и префиксы URL для управления локалями.

#### Свойства

- **headerName**:
  - _Тип_: `string`
  - _По умолчанию_: `'x-intlayer-locale'`
  - _Описание_: Имя HTTP-заголовка, используемого для определения локали.
  - _Пример_: `'x-custom-locale'`
  - _Заметка_: Это полезно для определения локали на основе API.
- **cookieName**:
  - _Тип_: `string`
  - _По умолчанию_: `'intlayer-locale'`
  - _Описание_: Имя cookie, используемого для хранения локали.
  - _Пример_: `'custom-locale'`
  - _Заметка_: Используется для сохранения локали между сессиями.
- **prefixDefault**:
  - _Тип_: `boolean`
  - _По умолчанию_: `true`
  - _Описание_: Указывает, следует ли включать локаль по умолчанию в URL.
  - _Пример_: `false`
  - _Заметка_: Если `false`, URL для локали по умолчанию не будут иметь префикс локали.
- **basePath**:
  - _Тип_: `string`
  - _По умолчанию_: `''`
  - _Описание_: Базовый путь для URL приложения.
  - _Пример_: `'/my-app'`
  - _Заметка_: Это влияет на то, как формируются URL для приложения.
- **serverSetCookie**:
  - _Тип_: `string`
  - _По умолчанию_: `'always'`
  - _Описание_: Правило для установки cookie локали на сервере.
  - _Варианты_: `'always'`, `'never'`
  - _Пример_: `'never'`
  - _Заметка_: Управляет тем, устанавливается ли cookie локали на каждый запрос или никогда.
- **noPrefix**:
  - _Тип_: `boolean`
  - _По умолчанию_: `false`
  - _Описание_: Указывает, следует ли опустить префикс локали из URL.
  - _Пример_: `true`
  - _Заметка_: Если `true`, URL не будут содержать информацию о локали.

---

### Конфигурация контента

Настройки, связанные с обработкой контента в приложении, включая имена каталогов, расширения файлов и производные конфигурации.

#### Свойства

- **watch**:
  - _Тип_: `boolean`
  - _По умолчанию_: `process.env.NODE_ENV === 'development'`
  - _Описание_: Указывает, должен ли Intlayer следить за изменениями в файлах декларации контента в приложении для перестройки связанных словарей.
- **fileExtensions**:
  - _Тип_: `string[]`
  - _По умолчанию_: `['.content.ts', '.content.js', '.content.cjs', '.content.mjs', '.content.json', '.content.tsx', '.content.jsx']`
  - _Описание_: Расширения файлов, которые нужно искать при построении словарей.
  - _Пример_: `['.data.ts', '.data.js', '.data.json']`
  - _Заметка_: Настройка расширений файлов может помочь избежать конфликтов.
- **baseDir**:
  - _Тип_: `string`
  - _По умолчанию_: `process.cwd()`
  - _Описание_: Базовый каталог для проекта.
  - _Пример_: `'/path/to/project'`
  - _Заметка_: Это используется для разрешения всех каталогов, связанных с Intlayer.
- **dictionaryOutput**:
  - _Тип_: `string[]`
  - _По умолчанию_: `['intlayer']`
  - _Описание_: Тип вывода словаря, который следует использовать, например, `'intlayer'` или `'i18next'`.
- **contentDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'src'`
  - _Описание_: Имя каталога, в котором хранится контент.
  - _Пример_: `'data'`, `'content'`, `'locales'`
  - _Заметка_: Если не на уровне базового каталога, обновите `contentDir`.
- **contentDir**:

  - _Тип_: `string`
  - _ПроизводноеОт_: `'baseDir'` / `'contentDirName'`
  - _Описание_: Путь к каталогу, где хранится контент.

- **resultDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'.intlayer'`
  - _Описание_: Имя каталога, в котором хранятся результаты.
  - _Пример_: `'outputOFIntlayer'`
  - _Заметка_: Если этот каталог не на базовом уровне, обновите `resultDir`.
- **resultDir**:

  - _Тип_: `string`
  - _ПроизводноеОт_: `'baseDir'` / `'resultDirName'`
  - _Описание_: Путь к каталогу для хранения промежуточных или выходных результатов.

- **moduleAugmentationDirName**:

  - _Тип_: `string`
  - _По умолчанию_: `'types'`
  - _Описание_: Каталог для увеличения модуля, позволяющий улучшить предложения IDE и проверку типов.
  - _Пример_: `'intlayer-types'`
  - _Заметка_: Убедитесь, что это включено в `tsconfig.json`.

- **moduleAugmentationDir**:

  - _Тип_: `string`
  - _ПроизводноеОт_: `'baseDir'` / `'moduleAugmentationDirName'`
  - _Описание_: Путь для увеличения модуля и дополнительных определений типов.

- **dictionariesDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'dictionary'`
  - _Описание_: Каталог для хранения словарей.
  - _Пример_: `'translations'`
  - _Заметка_: Если не на уровне каталога результатов, обновите `dictionariesDir`.
- **dictionariesDir**:

  - _Тип_: `string`
  - _ПроизводноеОт_: `'resultDir'` / `'dictionariesDirName'`
  - _Описание_: Каталог для хранения словарей локализации.

- **i18nDictionariesDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'i18n_dictionary'`
  - _Описание_: Каталог для хранения i18n словарей.
  - _Пример_: `'translations'`
  - _Заметка_: Если не на уровне каталога результатов, обновите `i18nDictionariesDir`.
  - _Заметка_: Убедитесь, что вывод i18n словарей включает i18next для построения словарей для i18next.
- **i18nDictionariesDir**:

  - _Тип_: `string`
  - _ПроизводноеОт_: `'resultDir'` / `'i18nDictionariesDirName'`
  - _Описание_: Каталог для хранения i18n словарей.
  - _Заметка_: Убедитесь, что этот каталог настроен для типа вывода i18next.

- **typeDirName**:

  - _Тип_: `string`
  - _По умолчанию_: `'types'`
  - _Описание_: Каталог для хранения типов словаря.
  - _Пример_: `'intlayer-types'`
  - _Заметка_: Если не на уровне каталога результатов, обновите `typesDir`.

- **typesDir**:

  - _Тип_: `string`
  - _ПроизводноеОт_: `'resultDir'` / `'typeDirName'`
  - _Описание_: Каталог для хранения типов словаря.

- **mainDirName**:
  - _Тип_: `string`
  - _По умолчанию_: `'main'`
  - _Описание_: Каталог для хранения основных файлов.
  - _Пример_: `'intlayer-main'`
  - _Заметка_: Если не на уровне каталога результатов, обновите `mainDir`.
- **mainDir**:
  - _Тип_: `string`
  - _ПроизводноеОт_: `'resultDir'` / `'mainDirName'`
  - _Описание_: Каталог, в котором хранятся основные файлы приложения.
- **excludedPath**:
  - _Тип_: `string[]`
  - _По умолчанию_: `['node_modules']`
  - _Описание_: Каталоги, исключенные из поиска контента.
  - _Заметка_: Эта настройка еще не используется, но запланирована для будущей реализации.
